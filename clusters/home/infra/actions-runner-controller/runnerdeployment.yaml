---
apiVersion: actions.summerwind.dev/v1alpha1
kind: RunnerDeployment
metadata:
  name: robopd2-runner
  namespace: actions-runner-system
spec:
  replicas: 1
  template:
    spec:
      # Repository-level runner (for cameronrosier/cams-lab)
      repository: cameronrosier/cams-lab
      # Optional: Use organization-level runner instead
      # organization: cameronrosier
      # Labels to identify this runner in GitHub Actions workflows
      labels:
        - self-hosted
        - kubernetes
        - robopd2
      # Docker image for the runner (supports ARM64 for Raspberry Pi)
      image: summerwind/actions-runner:latest
      # Resource constraints for Raspberry Pi
      resources:
        requests:
          cpu: 500m
          memory: 1Gi
        limits:
          cpu: 2000m
          memory: 4Gi
      # Volume mounts for build artifacts and Docker socket
      volumeMounts:
      - mountPath: /var/run/docker.sock
        name: docker-sock
      volumes:
      - name: docker-sock
        hostPath:
          path: /var/run/docker.sock
          type: Socket
      # Environment variables
      env:
      - name: DOCKER_HOST
        value: unix:///var/run/docker.sock
      # GitHub token for authentication (controller will use this from the secret)
      # The controller needs to be configured with the PAT via helm values
      # Service account for Kubernetes API access (if needed)
      # serviceAccountName: actions-runner
      # Node selector to prefer worker nodes (avoid control-plane)
      # nodeSelector:
      #   node-role.kubernetes.io/control-plane: "false"

